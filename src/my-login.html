<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/polymerfire/firebase-app.html">
<link rel="import" href="../bower_components/polymerfire/firebase-auth.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="shared-styles.html">

<dom-module id="my-login">
  <template id="bind" is="auto-binding">
    <style include="shared-styles">
      :host {
        display: block;

        padding: 10px;
      }
    </style>
    <firebase-auth id="auth" user="{{user}}" provider="google" on-error="handleError">
    </firebase-auth>
    <email-login></email-login>
    <login-btn></login-btn>
    <logout-btn></logout-btn>
  </template>

  <script>
    class MyLogin extends Polymer.Element {
      static get is() { return 'my-login'; }
    }
    window.customElements.define(MyLogin.is, MyLogin);
  </script>
</dom-module>

<dom-module id="email-login">
  <template>
    <paper-input id="email" label="Email" error-message="Please enter an email." required></paper-input>
    <paper-input id="password" label="Password" error-message="Please enter a password." required type="password"></paper-input>
    <paper-button raisedButton id="test" on-tap="loginEmail">Log In</paper-button>
    <paper-button raisedButton id="test" on-tap="signupEmail">Sign Up</paper-button>
  </template>
  <script>
    Polymer({
      is: 'email-login',
      loginEmail: function(e) {
        const email = this.$.email.value;
        const password = this.$.password.value;
        const auth = firebase.auth();
        const promise = auth.signInWithEmailAndPassword(email, password);
        promise
            .then(user => console.log(user))
        	.catch(e => console.log(e.message));
      },
     signupEmail: function(ee) {
       const email = this.$.email.value;
       const password = this.$.password.value;
       const auth = firebase.auth();
       const promise = auth.createUserWithEmailAndPassword(email, password);
       promise
       	.then(user => console.log(user))
       	.catch(ee => console.log(ee.message));
     }
    });
  </script>
</dom-module>

<dom-module id="login-btn">
  <template>
    <paper-button raisedButton id="test" on-tap="login">Log in with Google Account</paper-button>
  </template>
  <script>
    Polymer({
      is: 'login-btn',
      login: function(e) {
        var google = new firebase.auth.GoogleAuthProvider();
        firebase.auth().signInWithPopup(google);
      }
    });
  </script>
</dom-module>

<dom-module id="logout-btn">
  <template>
      <paper-button raisedButton id="btnLogout" on-tap="logout">Log Out</paper-button>
  </template>
  <script>
    Polymer({
      is: 'logout-btn',
      logout: function(e) {
        firebase.auth().signOut();
      }
    });
  </script>
</dom-module>
